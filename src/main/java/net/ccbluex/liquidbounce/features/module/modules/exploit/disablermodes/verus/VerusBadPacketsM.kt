package net.ccbluex.liquidbounce.features.module.modules.exploit.disablermodes.verus

import net.ccbluex.liquidbounce.event.EventState.PRE
import net.ccbluex.liquidbounce.event.events.MotionEvent
import net.ccbluex.liquidbounce.event.events.WorldEvent
import net.ccbluex.liquidbounce.features.module.modules.exploit.disablermodes.DisablerMode
import net.ccbluex.liquidbounce.utils.PacketUtils.sendPacket
import net.minecraft.network.play.client.C0BPacketEntityAction
import net.minecraft.network.play.client.C0BPacketEntityAction.Action.STOP_SPRINTING

/**
 * @author SkidBounce/SkidBounce
 * @author ManInMyVan
 */
object VerusBadPacketsM : DisablerMode("VerusBadPacketsM") {
    private var requireSend = false

    override fun onWorld(event: WorldEvent) = onEnable()
    override fun onEnable() {
        requireSend = true
    }

    override fun onMotion(event: MotionEvent) {
        if (requireSend && mc.thePlayer != null && event.eventState == PRE) {
            sendPacket(C0BPacketEntityAction(mc.thePlayer, STOP_SPRINTING))
            debug(Send, "UnSprint")
            requireSend = false
        }
    }
}
